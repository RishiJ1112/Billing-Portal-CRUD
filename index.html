<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Textile Billing Forms</title>
<style>
    body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: rgb(242, 147, 5);
    }
    .form-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 20px;
    }
    .form-section {
        flex: 1;
        background: #f9f9f9;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        min-width: 300px;
        box-sizing: border-box;
    }
    h2 {
        text-align: center;
        margin-bottom: 5px;
        padding: 5px;
    }

    .form-group {
        margin-bottom: 20px;
    }
    label {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
    }
    input[type="text"], input[type="date"], select, textarea {
        width: 100%;
        padding: 10px;
        border: 1px solid #ebb40e;
        border-radius: 4px;
        box-sizing: border-box;
        font-size: 16px;
    }
    .submit-button-container {
        width: 100%;
        text-align: center;
        margin-top: 20px;
        border: 1px ;
    }
    input[type="submit"] {
        background-color: #fdb706;
        color: rgb(3, 3, 3);
        padding: 12px 20px;
        border: none;
        border-radius: 5px 5px;
        cursor: pointer;
        font-size: 16px;
    }
    input[type="submit"]:hover {
        background-color: #ffda09;
    }

    .table-container {
        width: 100%;
        overflow-x: auto;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        min-width: 1200px; /* Adjust as needed */
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
        position: relative;
    }
    th {
        background-color: #f2f2f2;
    }
    .filter-container {
        text-align: center;
        margin-top: 20px;
    }
    .filter-container input[type="date"] {
        padding: 8px;
        font-size: 16px;
    }
    .edit-button{
        cursor: pointer;
        color: #0e0e0e;
        text-decoration: underline;
        background: none;
        border: none;
        padding: 5px;
    }
    
    .editing .edit-button {
        display: none;
    }
    .editing {
        display: inline;
    }

    input[type="button"] {
        background-color: #fdb706;
        color: rgb(17, 16, 16);
        padding: 12px 20px;
        border: none;
        border-radius: 5px 5px;
        cursor: pointer;
        font-size: 16px;
    }
    input[type="button"]:hover {
        background-color: #ffda09;
    }
    
    .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgb(0,0,0);
        background-color: rgba(0,0,0,0.4);
        padding-top: 60px;
    }
    .modal-content {
        background-color: rgb(242, 147, 5);
        margin: 5% auto;
        padding: 20px;
        border: 1px solid rgb(0,0,0);
        width: 80%;
        max-width: 500px;
    }
    .close {
        color: #0d0c0c;
        float: right;
        font-size: 28px;
        font-weight: bold;
    }
    .close:hover,
    .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
    }

    .edit-save-button{
        background-color: #fdb706;
        color: rgb(17, 16, 16);
        padding: 12px 20px;
        border: none;
        border-radius: 5px 5px;
        cursor: pointer;
        font-size: 16px;
    }

    .edit-save-button:hover {
        background-color: #ffda09;

    }

    @media (max-width: 768px) {
    .modal-content {
        width: 90%;  /* Adjust width for smaller screens */
        }
    }

@media (max-width: 600px) {
    .modal-content {
        width: 95%;  /* Further adjust width for even smaller screens */
        padding: 10px;  /* Reduce padding */
    }
    
    .form-group label {
        font-size: 14px;  /* Adjust label font size */
    }
    
    .form-group input {
        font-size: 14px;  /* Adjust input font size */
    }
    
    .modal-content button {
        padding: 10px 15px;  /* Adjust button padding */
        font-size: 14px;
        margin-bottom: 15px;  /* Adjust button font size */
    }
    }


    @media (max-width: 768px) {
        .form-container {
            flex-direction: column;
            align-items: center;
        }
    }
    @media (max-width: 600px) {
        .form-section {
            width: 100%;
            padding: 10px;
        }
        th, td {
            font-size: 14px;
        }
    }
</style>
</head>
<body>
    <div class="form-container">
        <div class="form-section">
            <u><h2>Billing Details</h2></u>
            <div class="form-group">
                <label for="name">Voucher Name:</label>
                <input type="text" id="vname" name="vname" required>
            </div>
            <div class="form-group">
                <label for="vdate">Voucher Date:</label>
                <input type="date" id="vdate" name="vdate" required>
            </div>
            <div class="form-group">
                <label for="dname">Document Number</label>
                <input type="text" id="dname" name="dname" required>
            </div>
            <div class="form-group">
                <label for="ddate">Document Date:</label>
                <input type="date" id="ddate" name="ddate" required>
            </div>
            <div class="form-group">
                <label for="partyName">Party Name:</label>
                <input type="text" id="partyName" name="partyName">
            </div>
        </div>

        <div class="form-section">
            <u><h2>Product Details</h2></u>
            <div class="form-group">
                <label for="takaID">Taka ID</label>
                <input type="text" id="takaID" name="takaID" required>
            </div>
            <div class="form-group">
                <label for="productName">Product name</label>
                <input type="text" id="productName" name="productName" required>
            </div>
            <div class="form-group">
                <label for="shade">Shade</label>
                <input type="text" id="shade" name="shade" required>
            </div>
            <div class="form-group">
                <label for="quantity">Quantity</label>
                <input type="text" id="quantity" name="quantity" required>
            </div>
            <div class="form-group">
                <label for="rate">Rate</label>
                <input type="text" id="rate" name="rate" required>
            </div>
        </div>
    </div>

    <div class="submit-button-container">
        <input type="submit" value="Submit Information" onclick="submitCombinedForm()">
    </div>

    <u><h2>Submitted Data</h2></u>
    <div class="table-container">
        <table id="dataTable">
            <thead>
                <tr>
                    <th>Voucher Name</th>
                    <th>Voucher Date</th>
                    <th>Document Number</th>
                    <th>Document Date</th>
                    <th>Party Name</th>
                    <th>Taka ID</th>
                    <th>Product Name</th>
                    <th>Shade</th>
                    <th>Quantity</th>
                    <th>Rate</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="dataBody">
                <!-- Data will be dynamically added here -->
            </tbody>
        </table>
    </div>

    <div class="submit-button-container">
        <input type="button" value="Send Data" onclick="sendDataToServer()">
    </div>

        <!-- Edit Modal -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeModal()">&times;</span>
               <u><h2>Edit Data</h2></u>
                <form id="editForm">
                    <div class="form-group">
                        <label for="editVname">Voucher Name:</label>
                        <input type="text" id="editVname" name="editVname" required>
                    </div>
                    <div class="form-group">
                        <label for="editVdate">Voucher Date:</label>
                        <input type="date" id="editVdate" name="editVdate" required>
                    </div>
                    <div class="form-group">
                        <label for="editDname">Document Number:</label>
                        <input type="text" id="editDname" name="editDname" required>
                    </div>
                    <div class="form-group">
                        <label for="editDdate">Document Date:</label>
                        <input type="date" id="editDdate" name="editDdate" required>
                    </div>
                    <div class="form-group">
                        <label for="editPartyName">Party Name:</label>
                        <input type="text" id="editPartyName" name="editPartyName">
                    </div>
                    <div class="form-group">
                        <label for="editTakaID">Taka ID:</label>
                        <input type="text" id="editTakaID" name="editTakaID" required>
                    </div>
                    <div class="form-group">
                        <label for="editProductName">Product Name:</label>
                        <input type="text" id="editProductName" name="editProductName" required>
                    </div>
                    <div class="form-group">
                        <label for="editShade">Shade:</label>
                        <input type="text" id="editShade" name="editShade" required>
                    </div>
                    <div class="form-group">
                        <label for="editQuantity">Quantity:</label>
                        <input type="text" id="editQuantity" name="editQuantity" required>
                    </div>
                    <div class="form-group">
                        <label for="editRate">Rate:</label>
                        <input type="text" id="editRate" name="editRate" required>
                    </div>
                    <button type="button" class="edit-save-button" onclick="saveChanges()">Save</button>
                </form>
            </div>
        </div>
    


    <script>
        function submitCombinedForm() {
            event.preventDefault();

            // Customer Information
            var vname = document.getElementById("vname").value;
            var vdate = document.getElementById("vdate").value;
            var dname = document.getElementById("dname").value;
            var ddate = document.getElementById("ddate").value;
            var partyName = document.getElementById("partyName").value;

            // Product Information
            var takaID = document.getElementById("takaID").value;
            var productName = document.getElementById("productName").value;
            var shade = document.getElementById("shade").value;
            var quantity = document.getElementById("quantity").value;
            var rate = document.getElementById("rate").value;

            // Validation
            if (!vname || !vdate || !dname || !ddate || !takaID || !productName || !shade || !quantity || !rate) {
                alert("Please fill in all required fields.");
                return;
            }

            var dataBody = document.getElementById("dataBody");

            // Check if row with same data already exists
            var rowExists = false;
            var rows = dataBody.getElementsByTagName("tr");
            for (var i = 0; i < rows.length; i++) {
                var cells = rows[i].getElementsByTagName("td");
                if (cells.length >= 10 &&
                    cells[0].innerText === vname &&
                    cells[1].innerText === vdate &&
                    cells[2].innerText === dname &&
                    cells[3].innerText === ddate &&
                    cells[4].innerText === partyName &&
                    cells[5].innerText === takaID &&
                    cells[6].innerText === productName &&
                    cells[7].innerText === shade &&
                    cells[8].innerText === quantity &&
                    cells[9].innerText === rate) {
                    rowExists = true;
                    break;
                }
            }

            if (rowExists) {
                alert("A row with the same data already exists.");
                return;
            }

            var newRow = dataBody.insertRow();

            var cell1 = newRow.insertCell(0);
            var cell2 = newRow.insertCell(1);
            var cell3 = newRow.insertCell(2);
            var cell4 = newRow.insertCell(3);
            var cell5 = newRow.insertCell(4);
            var cell6 = newRow.insertCell(5);
            var cell7 = newRow.insertCell(6);
            var cell8 = newRow.insertCell(7);
            var cell9 = newRow.insertCell(8);
            var cell10 = newRow.insertCell(9);
            var cell11 = newRow.insertCell(10);

            cell1.innerHTML = vname;
            cell2.innerHTML = vdate;
            cell3.innerHTML = dname;
            cell4.innerHTML = ddate;
            cell5.innerHTML = partyName;
            cell6.innerHTML = takaID;
            cell7.innerHTML = productName;
            cell8.innerHTML = shade;
            cell9.innerHTML = quantity;
            cell10.innerHTML = rate;
            cell11.innerHTML = "<button class='edit-button' onclick='editRow(this)'>Edit</button>"

            // Clear the input fields after submission
            document.getElementById("vname").value = "";
            document.getElementById("vdate").value = "";
            document.getElementById("dname").value = "";
            document.getElementById("ddate").value = "";
            document.getElementById("partyName").value = "";
            document.getElementById("takaID").value = "";
            document.getElementById("productName").value = "";
            document.getElementById("shade").value = "";
            document.getElementById("quantity").value = "";
            document.getElementById("rate").value = "";
        }

         let currentRow;

        function editRow(button) {
            currentRow = button.parentNode.parentNode;
            const cells = currentRow.getElementsByTagName('td');
            document.getElementById('editVname').value = cells[0].innerText;
            document.getElementById('editVdate').value = cells[1].innerText;
            document.getElementById('editDname').value = cells[2].innerText;
            document.getElementById('editDdate').value = cells[3].innerText;
            document.getElementById('editPartyName').value = cells[4].innerText;
            document.getElementById('editTakaID').value = cells[5].innerText;
            document.getElementById('editProductName').value = cells[6].innerText;
            document.getElementById('editShade').value = cells[7].innerText;
            document.getElementById('editQuantity').value = cells[8].innerText;
            document.getElementById('editRate').value = cells[9].innerText;
            document.getElementById('editModal').style.display = 'block';
        }

        function saveChanges() {
            const cells = currentRow.getElementsByTagName('td');
            cells[0].innerText = document.getElementById('editVname').value;
            cells[1].innerText = document.getElementById('editVdate').value;
            cells[2].innerText = document.getElementById('editDname').value;
            cells[3].innerText = document.getElementById('editDdate').value;
            cells[4].innerText = document.getElementById('editPartyName').value;
            cells[5].innerText = document.getElementById('editTakaID').value;
            cells[6].innerText = document.getElementById('editProductName').value;
            cells[7].innerText = document.getElementById('editShade').value;
            cells[8].innerText = document.getElementById('editQuantity').value;
            cells[9].innerText = document.getElementById('editRate').value;
            closeModal();
        }

        function closeModal() {
            document.getElementById('editModal').style.display = 'none';
        }

        window.onclick = function(event) {
            if (event.target == document.getElementById('editModal')) {
                closeModal();
            }
        }

        

        // function editRow(button) {
        //     var row = button.parentNode.parentNode;
        //     row.classList.add('editing');
        //     var cells = row.getElementsByTagName('td');
        //     for (var i = 0; i < cells.length - 1; i++) {
        //         var cell = cells[i];
        //         var value = cell.innerText;
        //         cell.innerHTML = '<input type="text" value="' + value + '">';
        //     }
        // }

        // function saveRow(button) {
        //     var row = button.parentNode.parentNode;
        //     row.classList.remove('editing');
        //     var inputs = row.getElementsByTagName('input');
        //     for (var i = 0; i < inputs.length ; i++) {
        //         var input = inputs[i];
        //         var value = input.value;
        //         var cell = input.parentNode;
        //         cell.innerText = value;
        //     }
        // }

        // function cancelEdit(button) {
        //     var row = button.parentNode.parentNode;
        //     row.classList.remove('editing');
        //     var inputs = row.getElementsByTagName('input');
        //     for (var i = 0; i < inputs.length ; i++) {
        //         var input = inputs[i];
        //         var value = input.defaultValue;
        //         var cell = input.parentNode;
        //         cell.innerText = value;
        //     }
        // }

        function sendDataToServer() {
            let table = document.getElementById("dataTable");
            let data = [];
            
            for (let i = 1, row; row = table.rows[i]; i++) {
                let rowData = {};
                rowData['vname'] = row.cells[0].innerText;
                rowData['vdate'] = row.cells[1].innerText;
                rowData['dname'] = row.cells[2].innerText;
                rowData['ddate'] = row.cells[3].innerText;
                rowData['partyName'] = row.cells[4].innerText;
                rowData['takaID'] = row.cells[5].innerText;
                rowData['productName'] = row.cells[6].innerText;
                rowData['shade'] = row.cells[7].innerText;
                rowData['quantity'] = row.cells[8].innerText;
                rowData['rate'] = row.cells[9].innerText;
                data.push(rowData);
            }

            fetch('/send-data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            }).then(response => {
                if (response.ok) {
                    alert("Data sent successfully!");
                } else {
                    alert("Failed to send data.");
                }
            }).catch(error => {
                alert("Error: " + error.message);
            });
        }
    </script>
</body>
</html>
